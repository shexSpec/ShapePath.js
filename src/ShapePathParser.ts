/* parser generated by jison 0.0.5 */
/**
 * Returns a Parser implementing JisonParserApi and a Lexer implementing JisonLexerApi.
 */

import {Union, Intersection, Path, Step, Axis, t_Selector, Assertion, Filter,
        Func, FuncArg, FuncName,
        t_termType, t_shapeExprType, t_tripleExprType, t_valueType, t_attribute,
        t_schemaAttr, t_shapeExprAttr, t_nodeConstraintAttr, t_stringFacetAttr,
        t_numericFacetAttr, t_valueSetValueAttr, t_shapeAttr, t_tripleExprAttr,
        t_tripleConstraintAttr, t_semActAttr, t_annotationAttr
       } from './ShapePathAst'

import {comparison, rvalue} from './ShapePathParserInternals'

function makeFunction (assertionP: boolean, firstArg: FuncArg, comp: comparison = { op: FuncName.ebv, r: null }): Func {
  const { op, r } = comp
  const args = [firstArg]
  if (r) args.push(r)
  const ret = new Filter(op, args)
  return assertionP
    ? new Assertion(ret)
    : ret
}

function pnameToUrl (pname: string, yy: any): URL {
  const idx = pname.indexOf(':')
  const pre = pname.substr(0, idx)
  const lname = pname.substr(idx+1)
  if (!(pre in yy.prefixes))
    throw Error(`unknown prefix in ${pname}`)
  const ns = yy.prefixes[pre]
  return new URL(ns + lname, yy.base)
}

export function shapeLabelShortCut(label: URL) {
  return [
    new Step(t_schemaAttr.shapes),
    new Step(t_Selector.Any, undefined, [
      new Filter(FuncName.equal, [
        new Path([new Step(t_attribute.id)]),
        label
      ]),
      new Assertion(
        new Filter(FuncName.equal, [
          new Filter(FuncName.count, []),
          1
        ])
      )
    ])
  ]
}


export function predicateShortCut(label: URL) {
  return [
    new Step(t_shapeExprType.Shape, Axis.thisShapeExpr),
    new Step(t_shapeAttr.expression),
    new Step(
      t_tripleExprType.TripleConstraint,
      Axis.thisTripleExpr,
      [
        new Filter(FuncName.equal, [
          new Path([new Step(t_attribute.predicate)]),
          label
        ])
      ]
    )
  ];
}


import { JisonParser, JisonParserApi, StateType, SymbolsType, TerminalsType, ProductionsType, o } from '@ts-jison/parser';
import { JisonLexer, JisonLexerApi } from '@ts-jison/lexer';

const $V0=[32,33,34,35,36,37,38,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,106,107,109,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,135,136,137,138,139],$V1=[2,17],$V2=[1,10],$V3=[1,11],$V4=[1,12],$V5=[1,13],$V6=[5,9,43,60,61,62],$V7=[5,9,13,43,60,61,62],$V8=[5,9,13,21,22,25,26,43,60,61,62],$V9=[38,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,106,107,109,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,135,136,137,138,139],$Va=[2,25],$Vb=[1,21],$Vc=[1,22],$Vd=[1,23],$Ve=[1,24],$Vf=[1,25],$Vg=[1,26],$Vh=[1,28],$Vi=[1,30],$Vj=[1,31],$Vk=[140,142,143],$Vl=[5,9,13,21,22,25,26,43,52,60,61,62],$Vm=[5,9,13,21,22,25,26,41,43,60,61,62],$Vn=[21,22,25,26,32,33,34,35,36,37,38,50,53,54,55,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,106,107,109,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,135,136,137,138,139],$Vo=[2,44],$Vp=[1,141],$Vq=[1,142],$Vr=[1,143],$Vs=[57,140,142,143],$Vt=[43,60,61,62];

export class ShapePathParser extends JisonParser implements JisonParserApi {
  public Parser?: ShapePathParser;
  $?: any;

  constructor (yy = {}, lexer = new ShapePathLexer(yy)) {
    super(yy, lexer);
  }

  symbols_: SymbolsType = {"error":2,"top":3,"shapePath":4,"EOF":5,"unionStep":6,"Q_O_QIT_union_E_S_QunionStep_E_C_E_Star":7,"O_QIT_union_E_S_QunionStep_E_C":8,"IT_UNION":9,"intersectionStep":10,"Q_O_QIT_intersection_E_S_QintersectionStep_E_C_E_Star":11,"O_QIT_intersection_E_S_QintersectionStep_E_C":12,"IT_INTERSECTION":13,"startStep":14,"QnextStep_E_Star":15,"nextStep":16,"Q_O_QGT_DIVIDE_E_Or_QGT_DIVIDE_DIVIDE_E_C_E_Opt":17,"step":18,"shortcut":19,"O_QGT_DIVIDE_E_Or_QGT_DIVIDE_DIVIDE_E_C":20,"IT_DIVIDE":21,"IT_DIVIDEDIVIDE":22,"O_QGT_AT_E_Or_QGT_DOT_E_C":23,"iri":24,"IT_AT":25,"IT_DOT":26,"Qaxis_E_Opt":27,"selector":28,"Qfilter_E_Star":29,"axis":30,"filter":31,"IT_child":32,"IT_thisShapeExpr":33,"IT_thisTripleExpr":34,"IT_self":35,"IT_parent":36,"IT_ancestor":37,"IT_STAR":38,"termType":39,"attribute":40,"IT_LBRACKET":41,"filterExpr":42,"IT_RBRACKET":43,"QIT_ASSERT_E_Opt":44,"Qcomparison_E_Opt":45,"function":46,"numericExpr":47,"IT_ASSERT":48,"comparison":49,"IT_index":50,"GT_LPAREN":51,"GT_RPAREN":52,"IT_count":53,"IT_foo1":54,"IT_foo2":55,"fooArg":56,"INTEGER":57,"comparitor":58,"rvalue":59,"IT_EQUAL":60,"IT_LT":61,"IT_GT":62,"shapeExprType":63,"tripleExprType":64,"valueType":65,"IT_Schema":66,"IT_SemAct":67,"IT_Annotation":68,"IT_ShapeAnd":69,"IT_ShapeOr":70,"IT_ShapeNot":71,"IT_NodeConstraint":72,"IT_Shape":73,"IT_ShapeExternal":74,"IT_EachOf":75,"IT_OneOf":76,"IT_TripleConstraint":77,"IT_IriStem":78,"IT_IriStemRange":79,"IT_LiteralStem":80,"IT_LiteralStemRange":81,"IT_Language":82,"IT_LanguageStem":83,"IT_LanguageStemRange":84,"IT_Wildcard":85,"IT_type":86,"IT_id":87,"IT_semActs":88,"IT_annotations":89,"IT_predicate":90,"schemaAttr":91,"shapeExprAttr":92,"tripleExprAttr":93,"valueSetValueAttr":94,"semActAttr":95,"annotationAttr":96,"GT_atContext":97,"IT_startActs":98,"IT_start":99,"IT_imports":100,"IT_shapes":101,"IT_shapeExprs":102,"IT_shapeExpr":103,"nodeConstraintAttr":104,"shapeAttr":105,"IT_nodeKind":106,"IT_datatype":107,"xsFacetAttr":108,"IT_values":109,"stringFacetAttr":110,"numericFacetAttr":111,"IT_length":112,"IT_minlength":113,"IT_maxlength":114,"IT_pattern":115,"IT_flags":116,"IT_mininclusive":117,"IT_minexclusive":118,"IT_maxinclusive":119,"IT_maxexclusive":120,"IT_totaldigits":121,"IT_fractiondigits":122,"IT_value":123,"IT_language":124,"IT_stem":125,"IT_exclusions":126,"IT_languageTag":127,"IT_closed":128,"IT_extra":129,"IT_expression":130,"IT_expressions":131,"IT_min":132,"IT_max":133,"tripleConstraintAttr":134,"IT_inverse":135,"IT_valueExpr":136,"IT_name":137,"IT_code":138,"IT_object":139,"IRIREF":140,"prefixedName":141,"PNAME_LN":142,"PNAME_NS":143,"$accept":0,"$end":1};
  terminals_: TerminalsType = {2:"error",5:"EOF",9:"IT_UNION",13:"IT_INTERSECTION",21:"IT_DIVIDE",22:"IT_DIVIDEDIVIDE",25:"IT_AT",26:"IT_DOT",32:"IT_child",33:"IT_thisShapeExpr",34:"IT_thisTripleExpr",35:"IT_self",36:"IT_parent",37:"IT_ancestor",38:"IT_STAR",41:"IT_LBRACKET",43:"IT_RBRACKET",48:"IT_ASSERT",50:"IT_index",51:"GT_LPAREN",52:"GT_RPAREN",53:"IT_count",54:"IT_foo1",55:"IT_foo2",57:"INTEGER",60:"IT_EQUAL",61:"IT_LT",62:"IT_GT",66:"IT_Schema",67:"IT_SemAct",68:"IT_Annotation",69:"IT_ShapeAnd",70:"IT_ShapeOr",71:"IT_ShapeNot",72:"IT_NodeConstraint",73:"IT_Shape",74:"IT_ShapeExternal",75:"IT_EachOf",76:"IT_OneOf",77:"IT_TripleConstraint",78:"IT_IriStem",79:"IT_IriStemRange",80:"IT_LiteralStem",81:"IT_LiteralStemRange",82:"IT_Language",83:"IT_LanguageStem",84:"IT_LanguageStemRange",85:"IT_Wildcard",86:"IT_type",87:"IT_id",88:"IT_semActs",89:"IT_annotations",90:"IT_predicate",97:"GT_atContext",98:"IT_startActs",99:"IT_start",100:"IT_imports",101:"IT_shapes",102:"IT_shapeExprs",103:"IT_shapeExpr",106:"IT_nodeKind",107:"IT_datatype",109:"IT_values",112:"IT_length",113:"IT_minlength",114:"IT_maxlength",115:"IT_pattern",116:"IT_flags",117:"IT_mininclusive",118:"IT_minexclusive",119:"IT_maxinclusive",120:"IT_maxexclusive",121:"IT_totaldigits",122:"IT_fractiondigits",123:"IT_value",124:"IT_language",125:"IT_stem",126:"IT_exclusions",127:"IT_languageTag",128:"IT_closed",129:"IT_extra",130:"IT_expression",131:"IT_expressions",132:"IT_min",133:"IT_max",135:"IT_inverse",136:"IT_valueExpr",137:"IT_name",138:"IT_code",139:"IT_object",140:"IRIREF",142:"PNAME_LN",143:"PNAME_NS"};
  productions_: ProductionsType = [0,[3,2],[4,2],[8,2],[7,0],[7,2],[6,2],[12,2],[11,0],[11,2],[10,2],[15,0],[15,2],[14,2],[14,1],[20,1],[20,1],[17,0],[17,1],[16,2],[16,1],[19,2],[23,1],[23,1],[18,3],[27,0],[27,1],[29,0],[29,2],[30,1],[30,1],[30,1],[30,1],[30,1],[30,1],[28,1],[28,1],[28,1],[31,3],[42,3],[42,3],[42,1],[44,0],[44,1],[45,0],[45,1],[46,3],[46,3],[46,4],[46,4],[56,2],[56,1],[56,1],[49,2],[58,1],[58,1],[58,1],[59,1],[59,1],[47,1],[39,1],[39,1],[39,1],[39,1],[39,1],[39,1],[63,1],[63,1],[63,1],[63,1],[63,1],[63,1],[64,1],[64,1],[64,1],[65,1],[65,1],[65,1],[65,1],[65,1],[65,1],[65,1],[65,1],[40,1],[40,1],[40,1],[40,1],[40,1],[40,1],[40,1],[40,1],[40,1],[40,1],[40,1],[91,1],[91,1],[91,1],[91,1],[91,1],[92,1],[92,1],[92,1],[92,1],[104,1],[104,1],[104,1],[104,1],[108,1],[108,1],[110,1],[110,1],[110,1],[110,1],[110,1],[111,1],[111,1],[111,1],[111,1],[111,1],[111,1],[94,1],[94,1],[94,1],[94,1],[94,1],[105,1],[105,1],[105,1],[93,1],[93,1],[93,1],[93,1],[134,1],[134,1],[95,1],[95,1],[96,1],[24,1],[24,1],[141,1],[141,1]];
  table: Array<StateType> = [o($V0,$V1,{3:1,4:2,6:3,10:4,14:5,17:6,19:7,20:8,23:9,21:$V2,22:$V3,25:$V4,26:$V5}),{1:[3]},{5:[1,14]},o($V6,[2,4],{7:15}),o($V7,[2,8],{11:16}),o($V8,[2,11],{15:17}),o($V9,$Va,{18:18,27:19,30:20,32:$Vb,33:$Vc,34:$Vd,35:$Ve,36:$Vf,37:$Vg}),o($V8,[2,14]),o($V0,[2,18]),{24:27,140:$Vh,141:29,142:$Vi,143:$Vj},o($V0,[2,15]),o($V0,[2,16]),o($Vk,[2,22]),o($Vk,[2,23]),{1:[2,1]},o([5,43,60,61,62],[2,2],{8:32,9:[1,33]}),o($V6,[2,6],{12:34,13:[1,35]}),o($V7,[2,10],{23:9,16:36,20:37,19:38,21:$V2,22:$V3,25:$V4,26:$V5}),o($V8,[2,13]),{28:39,38:[1,40],39:41,40:42,63:43,64:44,65:45,66:[1,46],67:[1,47],68:[1,48],69:[1,60],70:[1,61],71:[1,62],72:[1,63],73:[1,64],74:[1,65],75:[1,66],76:[1,67],77:[1,68],78:[1,69],79:[1,70],80:[1,71],81:[1,72],82:[1,73],83:[1,74],84:[1,75],85:[1,76],86:[1,49],87:[1,50],88:[1,51],89:[1,52],90:[1,53],91:54,92:55,93:56,94:57,95:58,96:59,97:[1,77],98:[1,78],99:[1,79],100:[1,80],101:[1,81],102:[1,82],103:[1,83],104:84,105:85,106:[1,98],107:[1,99],108:100,109:[1,101],110:107,111:108,112:[1,109],113:[1,110],114:[1,111],115:[1,112],116:[1,113],117:[1,114],118:[1,115],119:[1,116],120:[1,117],121:[1,118],122:[1,119],123:[1,90],124:[1,91],125:[1,92],126:[1,93],127:[1,94],128:[1,102],129:[1,103],130:[1,104],131:[1,86],132:[1,87],133:[1,88],134:89,135:[1,105],136:[1,106],137:[1,95],138:[1,96],139:[1,97]},o($V9,[2,26]),o($V9,[2,29]),o($V9,[2,30]),o($V9,[2,31]),o($V9,[2,32]),o($V9,[2,33]),o($V9,[2,34]),o($V8,[2,21]),o($Vl,[2,137]),o($Vl,[2,138]),o($Vl,[2,139]),o($Vl,[2,140]),o($V6,[2,5]),o($V0,$V1,{10:4,14:5,17:6,19:7,20:8,23:9,6:120,21:$V2,22:$V3,25:$V4,26:$V5}),o($V7,[2,9]),o($V0,$V1,{14:5,17:6,19:7,20:8,23:9,10:121,21:$V2,22:$V3,25:$V4,26:$V5}),o($V8,[2,12]),o($V9,$Va,{27:19,30:20,18:122,32:$Vb,33:$Vc,34:$Vd,35:$Ve,36:$Vf,37:$Vg}),o($V8,[2,20]),o($Vm,[2,27],{29:123}),o($Vm,[2,35]),o($Vm,[2,36]),o($Vm,[2,37]),o($Vm,[2,60]),o($Vm,[2,61]),o($Vm,[2,62]),o($Vm,[2,63]),o($Vm,[2,64]),o($Vm,[2,65]),o($Vm,[2,83]),o($Vm,[2,84]),o($Vm,[2,85]),o($Vm,[2,86]),o($Vm,[2,87]),o($Vm,[2,88]),o($Vm,[2,89]),o($Vm,[2,90]),o($Vm,[2,91]),o($Vm,[2,92]),o($Vm,[2,93]),o($Vm,[2,66]),o($Vm,[2,67]),o($Vm,[2,68]),o($Vm,[2,69]),o($Vm,[2,70]),o($Vm,[2,71]),o($Vm,[2,72]),o($Vm,[2,73]),o($Vm,[2,74]),o($Vm,[2,75]),o($Vm,[2,76]),o($Vm,[2,77]),o($Vm,[2,78]),o($Vm,[2,79]),o($Vm,[2,80]),o($Vm,[2,81]),o($Vm,[2,82]),o($Vm,[2,94]),o($Vm,[2,95]),o($Vm,[2,96]),o($Vm,[2,97]),o($Vm,[2,98]),o($Vm,[2,99]),o($Vm,[2,100]),o($Vm,[2,101]),o($Vm,[2,102]),o($Vm,[2,128]),o($Vm,[2,129]),o($Vm,[2,130]),o($Vm,[2,131]),o($Vm,[2,120]),o($Vm,[2,121]),o($Vm,[2,122]),o($Vm,[2,123]),o($Vm,[2,124]),o($Vm,[2,134]),o($Vm,[2,135]),o($Vm,[2,136]),o($Vm,[2,103]),o($Vm,[2,104]),o($Vm,[2,105]),o($Vm,[2,106]),o($Vm,[2,125]),o($Vm,[2,126]),o($Vm,[2,127]),o($Vm,[2,132]),o($Vm,[2,133]),o($Vm,[2,107]),o($Vm,[2,108]),o($Vm,[2,109]),o($Vm,[2,110]),o($Vm,[2,111]),o($Vm,[2,112]),o($Vm,[2,113]),o($Vm,[2,114]),o($Vm,[2,115]),o($Vm,[2,116]),o($Vm,[2,117]),o($Vm,[2,118]),o($Vm,[2,119]),o($V6,[2,3]),o($V7,[2,7]),o($V8,[2,19]),o($V8,[2,24],{31:124,41:[1,125]}),o($Vm,[2,28]),o($Vn,[2,42],{42:126,44:127,47:128,48:[1,129],57:[1,130]}),{43:[1,131]},o($V0,$V1,{6:3,10:4,14:5,17:6,19:7,20:8,23:9,4:132,46:133,21:$V2,22:$V3,25:$V4,26:$V5,50:[1,134],53:[1,135],54:[1,136],55:[1,137]}),{43:[2,41]},o($Vn,[2,43]),{43:[2,59]},o($Vm,[2,38]),{43:$Vo,45:138,49:139,58:140,60:$Vp,61:$Vq,62:$Vr},{43:$Vo,45:144,49:139,58:140,60:$Vp,61:$Vq,62:$Vr},{51:[1,145]},{51:[1,146]},{51:[1,147]},{51:[1,148]},{43:[2,39]},{43:[2,45]},{24:151,57:[1,150],59:149,140:$Vh,141:29,142:$Vi,143:$Vj},o($Vs,[2,54]),o($Vs,[2,55]),o($Vs,[2,56]),{43:[2,40]},{52:[1,152]},{52:[1,153]},{24:154,140:$Vh,141:29,142:$Vi,143:$Vj},{24:157,56:155,57:[1,156],140:$Vh,141:29,142:$Vi,143:$Vj},{43:[2,53]},{43:[2,57]},{43:[2,58]},o($Vt,[2,46]),o($Vt,[2,47]),{52:[1,158]},{52:[1,159]},{24:160,52:[2,51],140:$Vh,141:29,142:$Vi,143:$Vj},{52:[2,52]},o($Vt,[2,48]),o($Vt,[2,49]),{52:[2,50]}];
  defaultActions: {[key:number]: any} = {14:[2,1],128:[2,41],130:[2,59],138:[2,39],139:[2,45],144:[2,40],149:[2,53],150:[2,57],151:[2,58],157:[2,52],160:[2,50]};

  performAction (yytext:string, yyleng:number, yylineno:number, yy:any, yystate:number /* action[1] */, $$:any /* vstack */, _$:any /* lstack */): any {
/* this == yyval */
    var $0 = $$.length - 1;
    switch (yystate) {
case 1:
 return $$[$0-1]; 
case 2:
this.$ = $$[$0].length ? new Union([$$[$0-1]].concat($$[$0])) : $$[$0-1];
break;
case 3: case 7:
this.$ = $$[$0];
break;
case 4: case 8: case 11: case 27:
this.$ = [];
break;
case 5: case 9: case 28:
this.$ = $$[$0-1].concat([$$[$0]]);
break;
case 6:
this.$ = $$[$0].length ? new Intersection([$$[$0-1]].concat($$[$0])) : $$[$0-1];
break;
case 10:
this.$ = new Path($$[$0-1].concat($$[$0]));
break;
case 12:
this.$ = $$[$0-1].concat($$[$0]);
break;
case 13: case 19: case 52:
this.$ = [$$[$0]];
break;
case 17: case 25: case 44:
this.$ = null;
break;
case 21:
this.$ = $$[$0-1] === '@' ? shapeLabelShortCut($$[$0]) : predicateShortCut($$[$0]);
break;
case 24:
this.$ = new Step($$[$0-1], $$[$0-2] ? $$[$0-2] : undefined, $$[$0].length > 0 ? $$[$0] : undefined);
break;
case 29:
this.$ = Axis.child;
break;
case 30:
this.$ = Axis.thisShapeExpr;
break;
case 31:
this.$ = Axis.thisTripleExpr;
break;
case 32:
this.$ = Axis.self;
break;
case 33:
this.$ = Axis.parent;
break;
case 34:
this.$ = Axis.ancestor;
break;
case 35:
this.$ = t_Selector.Any;
break;
case 38:
this.$ = $$[$0-1];
break;
case 39: case 40:
this.$ = makeFunction($$[$0-2], $$[$0-1], $$[$0] ? $$[$0] : undefined);
break;
case 41:
this.$ = new Filter(FuncName.index, [$$[$0]]);
break;
case 42:
this.$ = false;
break;
case 43:
this.$ = true;
break;
case 46:
this.$ = new Filter(FuncName.index, []);
break;
case 47: case 48: case 49:
this.$ = new Filter(FuncName.count, []);
break;
case 50:
this.$ = [parseInt($$[$0-1]), $$[$0]];
break;
case 51:
this.$ = [parseInt($$[$0])];
break;
case 53:
this.$ = { op: $$[$0-1], r: $$[$0] };
break;
case 54:
this.$ = FuncName.equal;
break;
case 55:
this.$ = FuncName.lessThan;
break;
case 56:
this.$ = FuncName.greaterThan;
break;
case 57: case 59:
this.$ = parseInt($$[$0]);
break;
case 63:
this.$ = t_termType.Schema;
break;
case 64:
this.$ = t_termType.SemAct;
break;
case 65:
this.$ = t_termType.Annotation;
break;
case 66:
this.$ = t_shapeExprType.ShapeAnd;
break;
case 67:
this.$ = t_shapeExprType.ShapeOr;
break;
case 68:
this.$ = t_shapeExprType.ShapeNot;
break;
case 69:
this.$ = t_shapeExprType.NodeConstraint;
break;
case 70:
this.$ = t_shapeExprType.Shape;
break;
case 71:
this.$ = t_shapeExprType.ShapeExternal;
break;
case 72:
this.$ = t_tripleExprType.EachOf;
break;
case 73:
this.$ = t_tripleExprType.OneOf;
break;
case 74:
this.$ = t_tripleExprType.TripleConstraint;
break;
case 75:
this.$ = t_valueType.IriStem;
break;
case 76:
this.$ = t_valueType.IriStemRange;
break;
case 77:
this.$ = t_valueType.LiteralStem;
break;
case 78:
this.$ = t_valueType.LiteralStemRange;
break;
case 79:
this.$ = t_valueType.Language;
break;
case 80:
this.$ = t_valueType.LanguageStem;
break;
case 81:
this.$ = t_valueType.LanguageStemRange;
break;
case 82:
this.$ = t_valueType.Wildcard;
break;
case 83:
this.$ = t_attribute.type;
break;
case 84:
this.$ = t_attribute.id;
break;
case 85:
this.$ = t_attribute.semActs;
break;
case 86:
this.$ = t_attribute.annotations;
break;
case 87:
this.$ = t_attribute.predicate;
break;
case 94:
this.$ = t_schemaAttr.atContext;
break;
case 95:
this.$ = t_schemaAttr.startActs;
break;
case 96:
this.$ = t_schemaAttr.start;
break;
case 97:
this.$ = t_schemaAttr.imports;
break;
case 98:
this.$ = t_schemaAttr.shapes;
break;
case 99:
this.$ = t_shapeExprAttr.shapeExprs;
break;
case 100:
this.$ = t_shapeExprAttr.shapeExpr;
break;
case 103:
this.$ = t_nodeConstraintAttr.nodeKind;
break;
case 104:
this.$ = t_nodeConstraintAttr.datatype;
break;
case 106:
this.$ = t_nodeConstraintAttr.values;
break;
case 109:
this.$ = t_stringFacetAttr.length;
break;
case 110:
this.$ = t_stringFacetAttr.minlength;
break;
case 111:
this.$ = t_stringFacetAttr.maxlength;
break;
case 112:
this.$ = t_stringFacetAttr.pattern;
break;
case 113:
this.$ = t_stringFacetAttr.flags;
break;
case 114:
this.$ = t_numericFacetAttr.mininclusive;
break;
case 115:
this.$ = t_numericFacetAttr.minexclusive;
break;
case 116:
this.$ = t_numericFacetAttr.maxinclusive;
break;
case 117:
this.$ = t_numericFacetAttr.maxexclusive;
break;
case 118:
this.$ = t_numericFacetAttr.totaldigits;
break;
case 119:
this.$ = t_numericFacetAttr.fractiondigits;
break;
case 120:
this.$ = t_valueSetValueAttr.value;
break;
case 121:
this.$ = t_valueSetValueAttr.language;
break;
case 122:
this.$ = t_valueSetValueAttr.stem;
break;
case 123:
this.$ = t_valueSetValueAttr.exclusions;
break;
case 124:
this.$ = t_valueSetValueAttr.languageTag;
break;
case 125:
this.$ = t_shapeAttr.closed;
break;
case 126:
this.$ = t_shapeAttr.extra;
break;
case 127:
this.$ = t_shapeAttr.expression;
break;
case 128:
this.$ = t_tripleExprAttr.expressions;
break;
case 129:
this.$ = t_tripleExprAttr.min;
break;
case 130:
this.$ = t_tripleExprAttr.max;
break;
case 132:
this.$ = t_tripleConstraintAttr.inverse;
break;
case 133:
this.$ = t_tripleConstraintAttr.valueExpr;
break;
case 134:
this.$ = t_semActAttr.name;
break;
case 135:
this.$ = t_semActAttr.code;
break;
case 136:
this.$ = t_annotationAttr.object;
break;
case 137:
this.$ = new URL($$[$0].substr(1, $$[$0].length - 2), yy.base);
break;
case 139: case 140:
this.$ = pnameToUrl($$[$0], yy);
break;
    }
  }
}

/* generated by ts-jison-lex 0.0.5 */
export class ShapePathLexer extends JisonLexer implements JisonLexerApi {
  options: any = {"moduleName":"ShapePath"};
  constructor (yy = {}) {
    super(yy);
  }

  rules: RegExp[] = [/^(?:\s+|(#[^\u000a\u000d]*|<--([^-]|-[^-]|--[^>])*-->))/,/^(?:([Uu][Nn][Ii][Oo][Nn]))/,/^(?:([Ii][Nn][Tt][Ee][Rr][Ss][Ee][Cc][Tt][Ii][Oo][Nn]))/,/^(?:([Aa][Ss][Ss][Ee][Rr][Tt]))/,/^(?:child::)/,/^(?:thisShapeExpr::)/,/^(?:thisTripleExpr::)/,/^(?:self::)/,/^(?:parent::)/,/^(?:ancestor::)/,/^(?:index\b)/,/^(?:count\b)/,/^(?:foo1\b)/,/^(?:foo2\b)/,/^(?:Schema\b)/,/^(?:SemAct\b)/,/^(?:Annotation\b)/,/^(?:ShapeAnd\b)/,/^(?:ShapeOr\b)/,/^(?:ShapeNot\b)/,/^(?:NodeConstraint\b)/,/^(?:Shape\b)/,/^(?:ShapeExternal\b)/,/^(?:EachOf\b)/,/^(?:OneOf\b)/,/^(?:TripleConstraint\b)/,/^(?:IriStem\b)/,/^(?:IriStemRange\b)/,/^(?:LiteralStem\b)/,/^(?:LiteralStemRange\b)/,/^(?:Language\b)/,/^(?:LanguageStem\b)/,/^(?:LanguageStemRange\b)/,/^(?:Wildcard\b)/,/^(?:type\b)/,/^(?:id\b)/,/^(?:semActs\b)/,/^(?:annotations\b)/,/^(?:predicate\b)/,/^(?:@context\b)/,/^(?:startActs\b)/,/^(?:start\b)/,/^(?:imports\b)/,/^(?:shapes\b)/,/^(?:shapeExprs\b)/,/^(?:shapeExpr\b)/,/^(?:nodeKind\b)/,/^(?:datatype\b)/,/^(?:values\b)/,/^(?:length\b)/,/^(?:minlength\b)/,/^(?:maxlength\b)/,/^(?:pattern\b)/,/^(?:flags\b)/,/^(?:mininclusive\b)/,/^(?:minexclusive\b)/,/^(?:maxinclusive\b)/,/^(?:maxexclusive\b)/,/^(?:totaldigits\b)/,/^(?:fractiondigits\b)/,/^(?:value\b)/,/^(?:language\b)/,/^(?:stem\b)/,/^(?:exclusions\b)/,/^(?:languageTag\b)/,/^(?:closed\b)/,/^(?:extra\b)/,/^(?:expression\b)/,/^(?:expressions\b)/,/^(?:min\b)/,/^(?:max\b)/,/^(?:inverse\b)/,/^(?:valueExpr\b)/,/^(?:name\b)/,/^(?:code\b)/,/^(?:object\b)/,/^(?:(<([^\u0000-\u0020<>\"{}|^`\\]|(\\u([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f])|\\U([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f])))*>))/,/^(?:(((([A-Z]|[a-z]|[\u00c0-\u00d6]|[\u00d8-\u00f6]|[\u00f8-\u02ff]|[\u0370-\u037d]|[\u037f-\u1fff]|[\u200c-\u200d]|[\u2070-\u218f]|[\u2c00-\u2fef]|[\u3001-\ud7ff]|[\uf900-\ufdcf]|[\ufdf0-\ufffd]|[\uD800-\uDB7F][\uDC00-\uDFFF])((((([A-Z]|[a-z]|[\u00c0-\u00d6]|[\u00d8-\u00f6]|[\u00f8-\u02ff]|[\u0370-\u037d]|[\u037f-\u1fff]|[\u200c-\u200d]|[\u2070-\u218f]|[\u2c00-\u2fef]|[\u3001-\ud7ff]|[\uf900-\ufdcf]|[\ufdf0-\ufffd]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_|_\b)|-|[0-9]|[\u00b7]|[\u0300-\u036f]|[\u203f-\u2040])|\.)*((([A-Z]|[a-z]|[\u00c0-\u00d6]|[\u00d8-\u00f6]|[\u00f8-\u02ff]|[\u0370-\u037d]|[\u037f-\u1fff]|[\u200c-\u200d]|[\u2070-\u218f]|[\u2c00-\u2fef]|[\u3001-\ud7ff]|[\uf900-\ufdcf]|[\ufdf0-\ufffd]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_|_\b)|-|[0-9]|[\u00b7]|[\u0300-\u036f]|[\u203f-\u2040]))?)?:)(((([A-Z]|[a-z]|[\u00c0-\u00d6]|[\u00d8-\u00f6]|[\u00f8-\u02ff]|[\u0370-\u037d]|[\u037f-\u1fff]|[\u200c-\u200d]|[\u2070-\u218f]|[\u2c00-\u2fef]|[\u3001-\ud7ff]|[\uf900-\ufdcf]|[\ufdf0-\ufffd]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_|_\b)|:|[0-9]|((%([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%))))(((([A-Z]|[a-z]|[\u00c0-\u00d6]|[\u00d8-\u00f6]|[\u00f8-\u02ff]|[\u0370-\u037d]|[\u037f-\u1fff]|[\u200c-\u200d]|[\u2070-\u218f]|[\u2c00-\u2fef]|[\u3001-\ud7ff]|[\uf900-\ufdcf]|[\ufdf0-\ufffd]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_|_\b)|-|[0-9]|[\u00b7]|[\u0300-\u036f]|[\u203f-\u2040])|\.|:|((%([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%))))*)))/,/^(?:((([A-Z]|[a-z]|[\u00c0-\u00d6]|[\u00d8-\u00f6]|[\u00f8-\u02ff]|[\u0370-\u037d]|[\u037f-\u1fff]|[\u200c-\u200d]|[\u2070-\u218f]|[\u2c00-\u2fef]|[\u3001-\ud7ff]|[\uf900-\ufdcf]|[\ufdf0-\ufffd]|[\uD800-\uDB7F][\uDC00-\uDFFF])((((([A-Z]|[a-z]|[\u00c0-\u00d6]|[\u00d8-\u00f6]|[\u00f8-\u02ff]|[\u0370-\u037d]|[\u037f-\u1fff]|[\u200c-\u200d]|[\u2070-\u218f]|[\u2c00-\u2fef]|[\u3001-\ud7ff]|[\uf900-\ufdcf]|[\ufdf0-\ufffd]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_|_\b)|-|[0-9]|[\u00b7]|[\u0300-\u036f]|[\u203f-\u2040])|\.)*((([A-Z]|[a-z]|[\u00c0-\u00d6]|[\u00d8-\u00f6]|[\u00f8-\u02ff]|[\u0370-\u037d]|[\u037f-\u1fff]|[\u200c-\u200d]|[\u2070-\u218f]|[\u2c00-\u2fef]|[\u3001-\ud7ff]|[\uf900-\ufdcf]|[\ufdf0-\ufffd]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_|_\b)|-|[0-9]|[\u00b7]|[\u0300-\u036f]|[\u203f-\u2040]))?)?:))/,/^(?:(([+-])?([0-9])+))/,/^(?:@)/,/^(?:\.)/,/^(?:\*)/,/^(?:\()/,/^(?:\))/,/^(?:\[)/,/^(?:\])/,/^(?:\/\/)/,/^(?:\/)/,/^(?:=)/,/^(?:<)/,/^(?:>)/,/^(?:[a-zA-Z0-9_-]+)/,/^(?:.)/,/^(?:$)/];
  conditions: any = {"INITIAL":{"rules":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94],"inclusive":true}}
  performAction (yy:any,yy_:any,$avoiding_name_collisions:any,YY_START:any): any {
    var YYSTATE=YY_START;
    switch($avoiding_name_collisions) {
    case 0:/*skip*/
      break;
    case 1:return 9;
    case 2:return 13;
    case 3:return 48;
    case 4:return 32;
    case 5:return 33;
    case 6:return 34;
    case 7:return 35;
    case 8:return 36;
    case 9:return 37;
    case 10:return 50;
    case 11:return 53;
    case 12:return 54;
    case 13:return 55;
    case 14:return 66;
    case 15:return 67;
    case 16:return 68;
    case 17:return 69;
    case 18:return 70;
    case 19:return 71;
    case 20:return 72;
    case 21:return 73;
    case 22:return 74;
    case 23:return 75;
    case 24:return 76;
    case 25:return 77;
    case 26:return 78;
    case 27:return 79;
    case 28:return 80;
    case 29:return 81;
    case 30:return 82;
    case 31:return 83;
    case 32:return 84;
    case 33:return 85;
    case 34:return 86;
    case 35:return 87;
    case 36:return 88;
    case 37:return 89;
    case 38:return 90;
    case 39:return 97;
    case 40:return 98;
    case 41:return 99;
    case 42:return 100;
    case 43:return 101;
    case 44:return 102;
    case 45:return 103;
    case 46:return 106;
    case 47:return 107;
    case 48:return 109;
    case 49:return 112;
    case 50:return 113;
    case 51:return 114;
    case 52:return 115;
    case 53:return 116;
    case 54:return 117;
    case 55:return 118;
    case 56:return 119;
    case 57:return 120;
    case 58:return 121;
    case 59:return 122;
    case 60:return 123;
    case 61:return 124;
    case 62:return 125;
    case 63:return 126;
    case 64:return 127;
    case 65:return 128;
    case 66:return 129;
    case 67:return 130;
    case 68:return 131;
    case 69:return 132;
    case 70:return 133;
    case 71:return 135;
    case 72:return 136;
    case 73:return 137;
    case 74:return 138;
    case 75:return 139;
    case 76:return 140;
    case 77:return 142;
    case 78:return 143;
    case 79:return 57;
    case 80:return 25;
    case 81:return 26;
    case 82:return 38;
    case 83:return 51;
    case 84:return 52;
    case 85:return 41;
    case 86:return 43;
    case 87:return 22;
    case 88:return 21;
    case 89:return 60;
    case 90:return 61;
    case 91:return 62;
    case 92:return 'unexpected word "'+yy_.yytext+'"';
    case 93:return 'invalid character '+yy_.yytext;
    case 94:return 5;
    }
  }
}
